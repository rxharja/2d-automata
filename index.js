(()=>{var w=Symbol("@ts-pattern/matcher"),H="@ts-pattern/anonymous-select-key",O=function(t){return Boolean(t&&typeof t=="object")},T=function(t){return t&&!!t[w]},F=function t(n,e,r){if(O(n)){if(T(n)){var o=n[w]().match(e),c=o.matched,u=o.selections;return c&&u&&Object.keys(u).forEach(function(i){return r(i,u[i])}),c}if(!O(e))return!1;if(Array.isArray(n))return!!Array.isArray(e)&&n.length===e.length&&n.every(function(i,s){return t(i,e[s],r)});if(n instanceof Map)return e instanceof Map&&Array.from(n.keys()).every(function(i){return t(n.get(i),e.get(i),r)});if(n instanceof Set){if(!(e instanceof Set))return!1;if(n.size===0)return e.size===0;if(n.size===1){var a=Array.from(n.values())[0];return T(a)?Array.from(e.values()).every(function(i){return t(a,i,r)}):e.has(a)}return Array.from(n.values()).every(function(i){return e.has(i)})}return Object.keys(n).every(function(i){var s,l=n[i];return(i in e||T(s=l)&&s[w]().matcherType==="optional")&&t(l,e[i],r)})}return Object.is(e,n)};function v(t){var n;return(n={})[w]=function(){return{match:function(e){return{matched:Boolean(t(e))}}}},n}var st=v(function(t){return!0});var lt=v(function(t){return typeof t=="string"}),ft=v(function(t){return typeof t=="number"}),ht=v(function(t){return typeof t=="boolean"}),mt=v(function(t){return typeof t=="bigint"}),vt=v(function(t){return typeof t=="symbol"}),dt=v(function(t){return t==null});var K=function(t){return new J(t,[])},J=function(){function t(e,r){this.value=void 0,this.cases=void 0,this.value=e,this.cases=r}var n=t.prototype;return n.with=function(){var e=[].slice.call(arguments),r=e[e.length-1],o=[e[0]],c=[];return e.length===3&&typeof e[1]=="function"?(o.push(e[0]),c.push(e[1])):e.length>2&&o.push.apply(o,e.slice(1,e.length-1)),new t(this.value,this.cases.concat([{match:function(u){var a={},i=Boolean(o.some(function(s){return F(s,u,function(l,g){a[l]=g})})&&c.every(function(s){return s(u)}));return{matched:i,value:i&&Object.keys(a).length?H in a?a[H]:a:u}},handler:r}]))},n.when=function(e,r){return new t(this.value,this.cases.concat([{match:function(o){return{matched:Boolean(e(o)),value:o}},handler:r}]))},n.otherwise=function(e){return new t(this.value,this.cases.concat([{match:function(r){return{matched:!0,value:r}},handler:e}])).run()},n.exhaustive=function(){return this.run()},n.run=function(){for(var e=this.value,r=void 0,o=0;o<this.cases.length;o++){var c=this.cases[o],u=c.match(this.value);if(u.matched){e=u.value,r=c.handler;break}}if(!r){var a;try{a=JSON.stringify(this.value)}catch{a=this.value}throw new Error("Pattern matching error: no pattern matches value "+a)}return r(e,this.value)},t}();var p=(t,n,e)=>t(n(e)),P=(t,n)=>Array.from({length:n-t},(e,r)=>t+r);function A(t){let n="0123456789ABCDEF";return String(n.slice(t>>4&15,(t>>4&15)+1))+n.slice(t&15,(t&15)+1)}var N=(t,n,e)=>"#"+A(t)+A(n)+A(e);function Q(t,n,e,r,o,c,u,a,i){let[s,l,g]=[u!=null?u:128,a!=null?a:127,i!=null?i:50];return P(0,g).map(y=>{let E=Math.sin(t*y+r)*l+s,D=Math.sin(n*y+o)*l+s,W=Math.sin(e*y+c)*l+s;return N(E,D,W)})}var j=Q(.1,.1,.1,0,2,4,230,25),S=0;function q(){S>=j.length&&(S=0);let t=j[S];return S++,t}var M=(t,n)=>e=>p(x(n),k(t),e),R=(t,n)=>e=>p(x(n),_(t),e),U=(t,n)=>e=>p(L(n),k(t),e),V=(t,n)=>e=>p(L(n),_(t),e),x=t=>([n,e])=>[n,e-1<0?t:e-1],k=t=>([n,e])=>[n+1>t?0:n+1,e],L=t=>([n,e])=>[n,e+1>t?0:e+1],_=t=>([n,e])=>[n-1<0?t:n-1,e],Z=t=>(n,{x:e,y:r,grid:o})=>t.map(c=>c(n)).map(([c,u])=>o[c][u]).reduceRight((c,u)=>c+u,0),$=(t,n)=>Z([R(t,n),x(n),M(t,n),k(t),U(t,n),L(n),V(t,n),_(t)]),X=([t,n],e)=>K([e.grid[t][n],$(e.x,e.y)([t,n],e)]).with([0,3],()=>1).with([1,2],()=>1).with([1,3],()=>1).otherwise(()=>0),Y=([t,n],{x:e,y:r,grid:o})=>{let[[c,u],[a,i],[s,l]]=[R(e,r)([t,n]),x(r)([t,n]),M(e,r)([t,n])],[g,y,E]=[o[c][u],o[a][i],o[s][l]];return g^(y|E)},tt=([t,n],{x:e,y:r,grid:o})=>{let[[c,u],[a,i]]=[R(e,r)([t,n]),M(e,r)([t,n])],[s,l]=[o[c][u],o[a][i]];return s^l},nt=new Map([["Game of Life",X],["Rule 30",Y],["Hat",tt]]),G=(t,n)=>({...t,grid:t.grid.map((e,r)=>e.map((o,c)=>nt.get(n)([r,c],t)))});function I(t=3,n=3){let[e,r]=[t<3?3:t,n<3?3:n];return{grid:P(0,e).map(c=>P(0,r).map(u=>0)),x:e-1,y:r-1}}function et(t){t==="Game of Life"&&d.clearRect(0,0,m.width,m.height),b(h.grid),h=G(h,t)}function b(t){d.strokeStyle="#111",d.fillStyle=q(),t.map((n,e)=>n.map((r,o)=>{r===1?d.fillRect(e*f,o*f,f,f):d.strokeRect(e*f,o*f,f,f)}))}var B,rt=document.querySelector("#gol-start");rt.addEventListener("click",()=>{clearInterval(B),B=setInterval(()=>et(z),80)});var ot=document.querySelector("#gol-pause");ot.addEventListener("click",()=>{clearInterval(B)});var it=document.querySelector("#gol-random");it.addEventListener("click",()=>{h.grid.forEach((t,n)=>t.forEach((e,r)=>h.grid[n][r]=Math.random()>.85?1:0)),b(h.grid)});var ct=document.querySelector("#gol-clear");ct.addEventListener("click",()=>{d.clearRect(0,0,m.width,m.height),h.grid.forEach((t,n)=>t.forEach((e,r)=>h.grid[n][r]=0)),b(h.grid)});var C=document.querySelector("#rules"),z=C.value;C.addEventListener("change",()=>{z=C.value});var m=document.querySelector("#gol-canvas");m.addEventListener("mousedown",t=>{let[n,e]=[Math.floor(t.pageX/f),Math.floor(t.pageY/f)];h.grid[n][e]=1,b(h.grid)});var f=10,d=m.getContext("2d");m.width=window.innerWidth;m.height=window.innerHeight-100;var ut=Math.floor(window.innerWidth/f),at=Math.floor(window.innerHeight/f),h=I(ut,at);b(h.grid);})();
