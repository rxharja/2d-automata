(()=>{var m=Symbol("@ts-pattern/matcher"),R="@ts-pattern/anonymous-select-key",B=function(e){return Boolean(e&&typeof e=="object")},L=function(e){return e&&!!e[m]},y=function e(t,n,r){if(B(t)){if(L(t)){var i=t[m]().match(n),o=i.matched,c=i.selections;return o&&c&&Object.keys(c).forEach(function(a){return r(a,c[a])}),o}if(!B(n))return!1;if(Array.isArray(t))return!!Array.isArray(n)&&t.length===n.length&&t.every(function(a,s){return e(a,n[s],r)});if(t instanceof Map)return n instanceof Map&&Array.from(t.keys()).every(function(a){return e(t.get(a),n.get(a),r)});if(t instanceof Set){if(!(n instanceof Set))return!1;if(t.size===0)return n.size===0;if(t.size===1){var u=Array.from(t.values())[0];return L(u)?Array.from(n.values()).every(function(a){return e(u,a,r)}):n.has(u)}return Array.from(t.values()).every(function(a){return n.has(a)})}return Object.keys(t).every(function(a){var s,l=t[a];return(a in n||L(s=l)&&s[m]().matcherType==="optional")&&e(l,n[a],r)})}return Object.is(n,t)},g=function e(t){var n,r,i;return B(t)?L(t)?(n=(r=(i=t[m]()).getSelectionKeys)==null?void 0:r.call(i))!=null?n:[]:Array.isArray(t)?T(t,e):T(Object.values(t),e):[]},T=function(e,t){return e.reduce(function(n,r){return n.concat(t(r))},[])};function I(e){var t;return(t={})[m]=function(){return{match:function(n){var r={},i=function(o,c){r[o]=c};return n===void 0?(g(e).forEach(function(o){return i(o,void 0)}),{matched:!0,selections:r}):{matched:y(e,n,i),selections:r}},getSelectionKeys:function(){return g(e)},matcherType:"optional"}},t}function z(e){var t;return(t={})[m]=function(){return{match:function(n){if(!Array.isArray(n))return{matched:!1};var r={};if(n.length===0)return g(e).forEach(function(o){r[o]=[]}),{matched:!0,selections:r};var i=function(o,c){r[o]=(r[o]||[]).concat([c])};return{matched:n.every(function(o){return y(e,o,i)}),selections:r}},getSelectionKeys:function(){return g(e)}}},t}function W(){var e,t=[].slice.call(arguments);return(e={})[m]=function(){return{match:function(n){var r={},i=function(o,c){r[o]=c};return{matched:t.every(function(o){return y(o,n,i)}),selections:r}},getSelectionKeys:function(){return T(t,g)},matcherType:"and"}},e}function $(){var e,t=[].slice.call(arguments);return(e={})[m]=function(){return{match:function(n){var r={},i=function(o,c){r[o]=c};return T(t,g).forEach(function(o){return i(o,void 0)}),{matched:t.some(function(o){return y(o,n,i)}),selections:r}},getSelectionKeys:function(){return T(t,g)},matcherType:"or"}},e}function F(e){var t;return(t={})[m]=function(){return{match:function(n){return{matched:!y(e,n,function(){})}},getSelectionKeys:function(){return[]},matcherType:"not"}},t}function d(e){var t;return(t={})[m]=function(){return{match:function(n){return{matched:Boolean(e(n))}}}},t}function J(){var e,t=[].slice.call(arguments),n=typeof t[0]=="string"?t[0]:void 0,r=t.length===2?t[1]:typeof t[0]=="string"?void 0:t[0];return(e={})[m]=function(){return{match:function(i){var o,c=((o={})[n??R]=i,o);return{matched:r===void 0||y(r,i,function(u,a){c[u]=a}),selections:c}},getSelectionKeys:function(){return[n??R].concat(r===void 0?[]:g(r))}}},e}var Q=d(function(e){return!0}),re=Q,oe=d(function(e){return typeof e=="string"}),ie=d(function(e){return typeof e=="number"}),ce=d(function(e){return typeof e=="boolean"}),ae=d(function(e){return typeof e=="bigint"}),ue=d(function(e){return typeof e=="symbol"}),se=d(function(e){return e==null}),p={__proto__:null,optional:I,array:z,intersection:W,union:$,not:F,when:d,select:J,any:Q,_:re,string:oe,number:ie,boolean:ce,bigint:ae,symbol:ue,nullish:se,instanceOf:function(e){return d(function(t){return function(n){return n instanceof t}}(e))},typed:function(){return{array:z,optional:I,intersection:W,union:$,not:F,select:J,when:d}}},b=function(e){return new le(e,[])},le=function(){function e(n,r){this.value=void 0,this.cases=void 0,this.value=n,this.cases=r}var t=e.prototype;return t.with=function(){var n=[].slice.call(arguments),r=n[n.length-1],i=[n[0]],o=[];return n.length===3&&typeof n[1]=="function"?(i.push(n[0]),o.push(n[1])):n.length>2&&i.push.apply(i,n.slice(1,n.length-1)),new e(this.value,this.cases.concat([{match:function(c){var u={},a=Boolean(i.some(function(s){return y(s,c,function(l,S){u[l]=S})})&&o.every(function(s){return s(c)}));return{matched:a,value:a&&Object.keys(u).length?R in u?u[R]:u:c}},handler:r}]))},t.when=function(n,r){return new e(this.value,this.cases.concat([{match:function(i){return{matched:Boolean(n(i)),value:i}},handler:r}]))},t.otherwise=function(n){return new e(this.value,this.cases.concat([{match:function(r){return{matched:!0,value:r}},handler:n}])).run()},t.exhaustive=function(){return this.run()},t.run=function(){for(var n=this.value,r=void 0,i=0;i<this.cases.length;i++){var o=this.cases[i],c=o.match(this.value);if(c.matched){n=c.value,r=o.handler;break}}if(!r){var u;try{u=JSON.stringify(this.value)}catch{u=this.value}throw new Error("Pattern matching error: no pattern matches value "+u)}return r(n,this.value)},e}();var x=(e,t,n)=>e(t(n)),M=(e,t)=>Array.from({length:t-e},(n,r)=>e+r);function C(e){let t="0123456789ABCDEF";return`${t.slice(e>>4&15,(e>>4&15)+1)}${t.slice(e&15,(e&15)+1)}`}var fe=(e,t,n)=>"#"+C(e)+C(t)+C(n);function he(e,t,n,r,i,o,c,u,a){let[s,l,S]=[c!=null?c:128,u!=null?u:127,a!=null?a:50];return M(0,S).map(P=>{let _=Math.sin(e*P+r)*l+s,te=Math.sin(t*P+i)*l+s,ne=Math.sin(n*P+o)*l+s;return fe(_,te,ne)})}var U=he(.1,.1,.1,0,2,4,230,25),k=0;function V(){k>=U.length&&(k=0);let e=U[k];return k++,e}var Z=["Game of Life","Seeds","Life without Death","Day and Night","Diamoeba"],K=(e,t)=>n=>x(D(t),j(e),n),O=(e,t)=>n=>x(D(t),H(e),n),me=(e,t)=>n=>x(q(t),j(e),n),de=(e,t)=>n=>x(q(t),H(e),n),D=e=>([t,n])=>[t,n-1<0?e:n-1],j=e=>([t,n])=>[t+1>e?0:t+1,n],q=e=>([t,n])=>[t,n+1>e?0:n+1],H=e=>([t,n])=>[t-1<0?e:t-1,n],ge=e=>(t,{x:n,y:r,grid:i})=>e.map(o=>o(t)).map(([o,c])=>i[o][c]).reduceRight((o,c)=>o+c,0),E=(e,t)=>ge([O(e,t),D(t),K(e,t),j(e),me(e,t),q(t),de(e,t),H(e)]),ve=([e,t],n)=>b([n.grid[e][t],E(n.x,n.y)([e,t],n)]).with([0,3],()=>1).with([1,2],[1,3],()=>1).otherwise(()=>0),ye=([e,t],n)=>b([n.grid[e][t],E(n.x,n.y)([e,t],n)]).with([0,3],()=>1).with([1,p.number],()=>1).otherwise(()=>0),pe=([e,t],n)=>b([n.grid[e][t],E(n.x,n.y)([e,t],n)]).with([0,3],[0,p.when(r=>r>=5&&r<=8)],()=>1).with([1,p.when(r=>r>=5&&r<=8)],()=>1).otherwise(()=>0),be=([e,t],n)=>b([n.grid[e][t],E(n.x,n.y)([e,t],n)]).with([0,3],[0,p.when(r=>r>=6&&r<=8)],()=>1).with([1,3],[1,4],[1,p.when(r=>r>=6&&r<=8)],()=>1).otherwise(()=>0),we=([e,t],n)=>b([n.grid[e][t],E(n.x,n.y)([e,t],n)]).with([0,2],()=>1).otherwise(()=>0),Se=([e,t],{x:n,y:r,grid:i})=>{let[[o,c],[u,a],[s,l]]=[O(n,r)([e,t]),D(r)([e,t]),K(n,r)([e,t])],[S,P,_]=[i[o][c],i[u][a],i[s][l]];return S^(P|_)},Pe=([e,t],{x:n,y:r,grid:i})=>{let[[o,c],[u,a]]=[O(n,r)([e,t]),K(n,r)([e,t])],[s,l]=[i[o][c],i[u][a]];return s^l},Te=new Map([["Game of Life",ve],["Life without Death",ye],["Day and Night",be],["Diamoeba",pe],["Seeds",we],["Rule 30",Se],["Rule 90",Pe]]),X=(e,t)=>({...e,grid:e.grid.map((n,r)=>n.map((i,o)=>Te.get(t)([r,o],e)))});function Y(e=3,t=3){let[n,r]=[e<3?3:e,t<3?3:t];return{grid:M(0,n).map(o=>M(0,r).map(c=>0)),x:n-1,y:r-1}}function xe(e){Z.includes(e)&&w.clearRect(0,0,v.width,v.height),A(h.grid),h=X(h,e)}function A(e){w.strokeStyle="#111",w.fillStyle=V(),e.map((t,n)=>t.map((r,i)=>{r===1?w.fillRect(n*f,i*f,f,f):w.strokeRect(n*f,i*f,f,f)}))}var N,Ee=document.querySelector("#gol-start");Ee.addEventListener("click",()=>{clearInterval(N),N=setInterval(()=>xe(ee),1)});var Ae=document.querySelector("#gol-pause");Ae.addEventListener("click",()=>{clearInterval(N)});var Le=document.querySelector("#gol-random");Le.addEventListener("click",()=>{h.grid.forEach((e,t)=>e.forEach((n,r)=>h.grid[t][r]=Math.random()>.85?1:0)),A(h.grid)});var Re=document.querySelector("#gol-clear");Re.addEventListener("click",()=>{w.clearRect(0,0,v.width,v.height),h.grid.forEach((e,t)=>e.forEach((n,r)=>h.grid[t][r]=0)),A(h.grid)});var G=document.querySelector("#rules"),ee=G.value;G.addEventListener("change",()=>{ee=G.value});var v=document.querySelector("#gol-canvas");v.addEventListener("mousedown",e=>{let[t,n]=[Math.floor(e.pageX/f),Math.floor(e.pageY/f)];h.grid[t][n]=1,A(h.grid)});var f=10,w=v.getContext("2d");v.width=window.innerWidth;v.height=window.innerHeight-100;var ke=Math.floor(window.innerWidth/f),Me=Math.floor(window.innerHeight/f),h=Y(ke,Me);A(h.grid);})();
